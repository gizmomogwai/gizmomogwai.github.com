<!DOCTYPE html>
<html>
<head>
<title>"Build"</title>
<script src="../../../assets/jquery-1.7.2.min.js" type="text/javascript"></script>
<script src="../../../assets/jquery.tagcanvas-1.17.1.min.js" type="text/javascript"></script>
<script src="../../../assets/pagemap-1.2.0.min.js" type="text/javascript"></script>
<link href="../../../assets/styles/style.css" rel="stylesheet" type="text/css">
<link href="../../../assets/styles/prism.css" rel="stylesheet" type="text/css">
<meta charset="UTF-8" content="text/html; charset=UTF-8" http-equiv="content-type">
<script type="text/javascript">
$(document).ready(function() {
$('canvas.tagCloud').tagcanvas({
maxSpeed : 0.05,
depth : 0.075,
weightMode: 'both',
weight: true,
wheelZoom: true,
weightGradient: {0:'#cc9393', 1:'#607835'}, // 0.33:'#e2e4cb', 0.66:'#b4cb8a',
outlineColour: "#ffffff",
outlineMethod: "colour"
});
});
</script>
<script type="text/javascript">
$(document).ready(function() {
$('#disqus_thread').hide();
});
$(document).ready(function() {
$('#toggle_disqus_thread').click(function() {
$('#disqus_thread').fadeToggle();
});
});
</script>
<script type="text/javascript">
$(document).ready(function() {
console.log(document.querySelector("a:visited"));
pagemap(document.querySelector('#map'), {
viewport: null,
styles: {
'nav,footer,div#main': 'rgba(0,0,0,0.08)',
'div.chapter,h1,img': 'rgba(255,255,255,0.2)',
'a.header,.page': getComputedStyle(document.querySelector(".page"))["color"],
'a[href]': getComputedStyle(document.querySelector("a[href]"))["color"],
'h2,h3,h4': 'rgba(0,0,0,0.08)'
},
back: 'rgba(255,255,255,0.5)',
view: 'rgba(0,0,0,0.05)',
drag: 'rgba(0,0,0,0.10)',
interval: null
});
});
</script>
<script src="../../../assets/google-analytics-tracking.js" type="text/javascript"></script>
<script integrity="sha384-6w2SekMzCkuMQ9sEbq0cLviD/yR2HfA/+ekmKiBnFlsoSvb/VmQFSi/umVShadQI" src="//instant.page/1.0.0" type="module"></script>
</head>
<body><div id="all">
<nav><div class="parentfirst first"><a href="../../../">Home</a></div>
<div class="parent"><a href="../../">Projects</a></div>
<div class="parentlast"><a href="../">Best Practices</a></div>
<div class="current last">Build</div></nav><div id="main">
<h2 class="page">Build</h2>
<div class="chapter">
<p>
Building software projects is hard. Here are some best practices:
<a class="header">Make it fast</a>
</p>
<div class="chapter">
<p>
There is the continuous struggle
between make it right and make it fast.
<a href="https://bazel.build/">Some</a> buildsystems promise to
combine both goals.
</p>
</div>
<a class="header">Make dev builds superfast</a>
<div class="chapter">
<p>
We all know that multitasking is evil. Every build that runs
longer than 10s <a href="https://xkcd.com/303/&gt;enhances&lt;/a&gt;%0Athe%20chance%20that%20we%20drift%20off%20an%20start%20multitasking.%0A&lt;/p&gt;%0A&lt;/div&gt;%0A&lt;a%20class='header'&gt;Incremental&lt;/a&gt;%0A&lt;div%20class='chapter'&gt;&lt;/div&gt;%0A&lt;a%20class='header'&gt;Put%20version%20and%20build%20information%20into%20product&lt;/a&gt;%0A&lt;div%20class='chapter'&gt;%0A&lt;p&gt;%0AWhile%20a%20builddate%20is%20very%20convenient%20for%20humans%20to%20process%20it%0Ais%20a%20hard%20to%20do%20reproducible%20builds%20with%20this,%20unless%20you%20inject%0Athe%20date%20from%20the%20outside%20into%20the%20product.%20Inversion%20of%20control%0Ado%20not%20just%20call%20/usr/bin/date%20but%20let%20the%20buildserver%20prepare%0Athe%20date%20for%20you%20e.g.%20in%20an%20environment%20variable.%0A&lt;/p&gt;%0A&lt;/div&gt;%0A&lt;a%20class='header'&gt;Build%20releases%20from%20clean%20builds&lt;/a&gt;%0A&lt;div%20class='chapter'&gt;%0A&lt;p&gt;%0AJust%20to%20be%20on%20the%20safe%20side%20a%20release%20build%20should%20start%20from%0Ascratch.%0A&lt;/p&gt;%0A&lt;/div&gt;%0A&lt;a%20class='header'&gt;Make%20a%20clean%20build%20once%20a%20day&lt;/a&gt;%0A&lt;div%20class='chapter'&gt;%0A&lt;p&gt;%0AJust%20to%20make%20sure,%20that%20everything%20including%20licenses%20and%20os%0Aupdates%20still%20works%20as%20expected.%0A&lt;/p&gt;%0A&lt;/div&gt;%0A&lt;a%20class='header'&gt;Make%20workspace%20as%20small%20as%20possible&lt;/a&gt;%0A&lt;div%20class='chapter'&gt;%0A&lt;p&gt;%0ALess%20data%20is%20always%20better.%20Faster%20clones,%20less%20resources%20taken,%0Aopens%20the%20option%20to%20have%20more%20builds%20in%20parallel.%0A&lt;/p&gt;%0A&lt;p&gt;%0AMake%20it%20even%20smaller%20for%20the%20buildserver.%20It%20probably%20does%20not%0Aneed%20all%20the%20docs%20that%20you%20have%20checked%20in.%0A&lt;/p&gt;%0A&lt;/div&gt;%0A&lt;a%20class='header'&gt;Make%20your%20build%20correct&lt;/a&gt;%0A&lt;div%20class='chapter'&gt;%0A&lt;p&gt;%0AIf%20it%20behaves%20in%20unexpected%20ways,%20fix%20it.%0A&lt;/p&gt;%0A&lt;/div&gt;%0A&lt;a%20class='header'&gt;Does%20your%20build%20delete%20" old files>
<div class="chapter">
<p>
Interesting example for incorrect builds.
</p>
</div>
</a><a class="header">Clone shallow vs. Clone full</a>
</p>
<div class="chapter">
<p>
Normally a buildserver is not interested in the history of the
repository. On the other hand it needs some context, to show
what was changed. For me the best option is a shallow clone,
that can be also used to incrementally pull. Because a pull with
not much changes will still be faster than a full shallow clone.
</p>
</div>
<a class="header">Keep the buildfile as small as possible</a>
<div class="chapter">
<p>
The build should be as simple as possible.
e.g. make is better than make clean generate build test release
</p>
</div>
<a class="header">All parties should use one buildfile</a>
<div class="chapter">
<p>
The buildfile should work for all parties. Its a wide range from
developers to buildservers. If all use the same, errors are
found earlier on and the project makes sure that all important
steps are in git.
</p>
</div>
<a class="header">Bring your own tools</a>
<div class="chapter">
<p>
My first choice is to not depend on preinstalled tools but put
everything into the workspace and make it self contained.
Another option is using docker images, but this has another set
of drawbacks.
</p>
</div>
<a class="header">Try to avoid gaps/bridges between buildsystems</a>
<div class="chapter">
<p>
Every gap between different buildsystems makes the whole image
less correct / efficient. E.g. recursive make considered
harmful.
</p>
</div>
<a class="header">Build out of source</a>
<div class="chapter">
<p>
Put all build artifacts to a common folder structure that is
outside of the source folders. This makes your gitignore files
very straight forward + you do not even need a clean buildstep,
because you just can delete one folder.
</p>
</div>
<a class="header">Keep your logs down</a>
<div class="chapter">
<p>
Make your buildlogs meaningful. Reduce warnings, remove debug
output.
</p>
</div>
<a class="header">Keep only what you need - aka jenkins archives</a>
<div class="chapter">
<p>
The results of a build should be as compact as possible.
Saving everything without a requirement is not fast and not
cheap.
</p>
</div>
<a class="header">Let the buildserver scale your build</a>
<div class="chapter">
<p>
Do not hardcode -j16 or something into your build. This should
be possible for the buildservers to decide. They know best what
resources they have and how many parallel jobs they have to
serve.
</p>
</div>
<a class="header">Dirty but fast</a>
<div class="chapter">
<p>
A viable compromis might be to do some edges of the build in a
dirty way, if it really brings speed. E.g. create dockerimages
with a snapshot, so that not all work has to be done from
scratch.
</p>
</div>

</div>Â </div>
<footer>last modified: 2019-11-07 | <a id="toggle_disqus_thread" data-disqus-identifier="Build">Comments</a> | Tags <a href="../../../sitemap/tags/#basics" rel="tag">basics</a>, <a href="../../../sitemap/tags/#build" rel="tag">build</a>, <a href="../../../sitemap/tags/#building" rel="tag">building</a></footer><div id="disqus_thread">
<script type="text/javascript">var disqus_shortname = 'gizmomogwai';
(function () {
  var s = document.createElement('script'); s.async = true;
  s.type = 'text/javascript';
  s.src = 'https://gizmomogwai.disqus.com/count.js';
  (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>
<script type="text/javascript">var disqus_identifier = 'Build';
var disqus_shortname = 'gizmomogwai';
(function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = '//gizmomogwai.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
</div>
</div>
<canvas id="map"></canvas>
</div></body>
</html>
